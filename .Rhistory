group_by(x7_county) |>
summarize(num_chems = nrow(x7_county),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100)
ma_2024 |>
group_by(x7_county) |>
summarize(num_chems = nrow(x7_county),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = x7_county)
temp <- ma_2024 |>
group_by(x7_county, x23_industry_sector) |>
summarize(sum = n()) |>
arrange(desc(sum)) |>
slice(1) |>
select(!sum)
ma_2024 |>
group_by(x7_county) |>
summarize(num_chems = nrow(x7_county),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = x7_county)
ma_2024 |>
group_by(x7_county) |>
summarize(num_chems = nrow(x7_county),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = join_by(x7_county))
chemstats <- function(data, area = c("county", "city", "zip")) {
if (area == "county") {
temp <- data |>
group_by(x7_county, x23_industry_sector) |>
summarize(sum = n()) |>
arrange(desc(sum)) |>
slice(1) |>
select(!sum)
result <- data |>
group_by(x7_county) |>
summarize(num_chems = nrow(x7_county),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = join_by(x7_county))
}
}
chemstats(ma_2024, county)
chemstats(ma_2024, "county")
chemstats <- function(data, area = c("county", "city", "zip")) {
if (area == "county") {
temp <- data |>
group_by(x7_county, x23_industry_sector) |>
summarize(sum = n()) |>
arrange(desc(sum)) |>
slice(1) |>
select(!sum)
result <- data |>
group_by(x7_county) |>
summarize(num_chems = nrow(x7_county),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = join_by(x7_county))
result
}
}
chemstats(ma_2024, "county")
chemstats <- function(data, area = c("county", "city", "zip")) {
if (area == "county") {
temp <- data |>
group_by(x7_county, x23_industry_sector) |>
summarize(sum = n()) |>
arrange(desc(sum)) |>
slice(1) |>
select(!sum)
result <- data |>
group_by(x7_county) |>
summarize(num_chems = n(),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = join_by(x7_county))
result
}
}
chemstats(ma_2024, "county")
devtools::document()
devtools::document()
rm(chemstats)
devtools::document()
library(usmap)
install.packages("usmap")
library(usmap)
plot_usmap()
plot_usmap(regions = 'counties')
df <- ma_2024 |>
group_by(x7_county) |>
summarize(num = n())
plot_usmap(regions = 'counties',
data = df,
values = "num")
df <- ma_2024 |>
group_by(x7_county) |>
rename("county" = x7_county) |>
summarize(num = n())
plot_usmap(regions = 'counties',
data = df,
values = "num")
df
library(epar)
data("ma_2024")
force(ma_2024)
View(ma_2024)
clean_names(ma_2024)
library(janitor)
clean_names(ma_2024)
ma_2024 <- clean_names(ma_2024)
}
chemstats <- function(data, area = c("county", "city", "zip")) {
if (area == "county") {
grouping_var <- `x7_county`
} else if (area == "city") {
grouping_var <- `x6_city`
} else if (area == "zip") {
grouping_var <- `x8_zip`
}
temp <- data |>
group_by(grouping_var, x23_industry_sector)
summarize(sum = n()) |>
arrange(desc(sum)) |>
slice(1) |>
select(!sum)
result <- data |>
group_by(grouping_var) |>
summarize(num_releases = n(),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = join_by(grouping_var)) |>
rename(top_industry = x23_industry_sector)
return(result)
}
chemstats(ma_2024, "county")
if (area == "county") {
grouping_var <- `x7_county`
} else if (area == "city") {
grouping_var <- `x6_city`
} else if (area == "zip") {
grouping_var <- `x8_zip`
}
chemstats <- function(data, area = c("county", "city", "zip")) {
if (area == "county") {
grouping_var <- x7_county
} else if (area == "city") {
grouping_var <- `x6_city`
} else if (area == "zip") {
grouping_var <- `x8_zip`
}
temp <- data |>
group_by(grouping_var, x23_industry_sector)
summarize(sum = n()) |>
arrange(desc(sum)) |>
slice(1) |>
select(!sum)
result <- data |>
group_by(grouping_var) |>
summarize(num_releases = n(),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = join_by(grouping_var)) |>
rename(top_industry = x23_industry_sector)
return(result)
}
chemstats(ma_2024, "county")
chemstats <- function(data, area = c("county", "city", "zip")) {
if (area == "county") {
grouping_var <- x7_county
} else if (area == "city") {
grouping_var <- `x6_city`
} else if (area == "zip") {
grouping_var <- `x8_zip`
}
browser()
temp <- data |>
group_by(grouping_var, x23_industry_sector)
summarize(sum = n()) |>
arrange(desc(sum)) |>
slice(1) |>
select(!sum)
result <- data |>
group_by(grouping_var) |>
summarize(num_releases = n(),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = join_by(grouping_var)) |>
rename(top_industry = x23_industry_sector)
return(result)
}
chemstats(ma_2024, "county")
chemstats <- function(data, area = c("county", "city", "zip")) {
if (area == "county") {
grouping_var <- x7_county
} else if (area == "city") {
grouping_var <- `x6_city`
} else if (area == "zip") {
grouping_var <- `x8_zip`
}
browser()
temp <- data |>
group_by(grouping_var, x23_industry_sector)
summarize(sum = n()) |>
arrange(desc(sum)) |>
slice(1) |>
select(!sum)
result <- data |>
group_by(grouping_var) |>
summarize(num_releases = n(),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = join_by(grouping_var)) |>
rename(top_industry = x23_industry_sector)
return(result)
}
chemstats(ma_2024, "county")
chemstats <- function(data, area = c("county", "city", "zip")) {
if (area == "county") {
grouping_var <- "x7_county"
} else if (area == "city") {
grouping_var <- `x6_city`
} else if (area == "zip") {
grouping_var <- `x8_zip`
}
browser()
temp <- data |>
group_by(grouping_var, x23_industry_sector)
summarize(sum = n()) |>
arrange(desc(sum)) |>
slice(1) |>
select(!sum)
result <- data |>
group_by(grouping_var) |>
summarize(num_releases = n(),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = join_by(grouping_var)) |>
rename(top_industry = x23_industry_sector)
return(result)
}
chemstats(ma_2024, "county")
chemstats(ma_2024, "county")
my <- function(data, area = c("county", "city", "zip")) {
if (area == "county") {
grouping_var <- "x7_county"
} else if (area == "city") {
grouping_var <- `x6_city`
} else if (area == "zip") {
grouping_var <- `x8_zip`
}
browser()
temp <- data |>
group_by(grouping_var, x23_industry_sector)
summarize(sum = n()) |>
arrange(desc(sum)) |>
slice(1) |>
select(!sum)
result <- data |>
group_by(grouping_var) |>
summarize(num_releases = n(),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = join_by(grouping_var)) |>
rename(top_industry = x23_industry_sector)
return(result)
}
my(ma_2024, "county")
library(dplyr)
my(ma_2024, "county")
my <- function(data, area = c("county", "city", "zip")) {
if (area == "county") {
grouping_var <- `x7_county`
} else if (area == "city") {
grouping_var <- `x6_city`
} else if (area == "zip") {
grouping_var <- `x8_zip`
}
browser()
temp <- data |>
group_by(grouping_var, x23_industry_sector)
summarize(sum = n()) |>
arrange(desc(sum)) |>
slice(1) |>
select(!sum)
result <- data |>
group_by(grouping_var) |>
summarize(num_releases = n(),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = join_by(grouping_var)) |>
rename(top_industry = x23_industry_sector)
return(result)
}
my(ma_2024, "county")
my <- function(data, area = c("county", "city", "zip")) {
grouping_var <- switch(area,
"county" = "x7_county",
"city" = "x6_city",
"zip" = "x8_zip")
temp <- data |>
group_by(.data$grouping_var, x23_industry_sector) |>
summarize(sum = n()) |>
arrange(desc(sum)) |>
slice(1) |>
select(!sum)
result <- data |>
group_by(.data$grouping_var) |>
summarize(num_releases = n(),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = join_by(.data$grouping_var)) |>
rename(top_industry = x23_industry_sector)
return(result)
}
my(ma_2024, "county")
my <- function(data, area = c("county", "city", "zip")) {
grouping_var <- switch(area,
"county" = "x7_county",
"city" = "x6_city",
"zip" = "x8_zip")
temp <- data |>
group_by(.data[[grouping_var]], x23_industry_sector) |>
summarize(sum = n()) |>
arrange(desc(sum)) |>
slice(1) |>
select(!sum)
result <- data |>
group_by(.data[[grouping_var]]) |>
summarize(num_releases = n(),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = join_by(.data[[grouping_var]])) |>
rename(top_industry = x23_industry_sector)
return(result)
}
my(ma_2024, "county")
my <- function(data, area = c("county", "city", "zip")) {
grouping_var <- switch(area,
"county" = "x7_county",
"city" = "x6_city",
"zip" = "x8_zip")
temp <- data |>
group_by(.data[[grouping_var]], x23_industry_sector) |>
summarize(sum = n()) |>
arrange(desc(sum)) |>
slice(1) |>
select(!sum)
result <- data |>
group_by(.data[[grouping_var]]) |>
summarize(num_releases = n(),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = grouping_var)) |>
my <- function(data, area = c("county", "city", "zip")) {
grouping_var <- switch(area,
"county" = "x7_county",
"city" = "x6_city",
"zip" = "x8_zip")
temp <- data |>
group_by(.data[[grouping_var]], x23_industry_sector) |>
summarize(sum = n()) |>
arrange(desc(sum)) |>
slice(1) |>
select(!sum)
result <- data |>
group_by(.data[[grouping_var]]) |>
summarize(num_releases = n(),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = grouping_var) |>
rename(top_industry = x23_industry_sector)
return(result)
}
my(ma_2024, "county")
my <- function(data, area = c("county", "city", "zip")) {
grouping_var <- switch(area,
"county" = "x7_county",
"city" = "x6_city",
"zip" = "x8_zip")
temp <- data |>
group_by(.data[[grouping_var]], x23_industry_sector) |>
summarize(sum = n()) |>
arrange(desc(sum)) |>
slice(1) |>
select(!sum)
result <- data |>
group_by(.data[[grouping_var]]) |>
summarize(num_releases = n(),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = grouping_var) |>
rename("top_industry" = x23_industry_sector)
return(result)
}
my(ma_2024, "county")
my <- function(data, area = c("county", "city", "zip")) {
grouping_var <- switch(area,
"county" = "x7_county",
"city" = "x6_city",
"zip" = "x8_zip")
temp <- data |>
group_by(.data[[grouping_var]], x23_industry_sector) |>
summarize(sum = n()) |>
arrange(desc(sum)) |>
slice(1) |>
select(!sum)
result <- data |>
group_by(.data[[grouping_var]]) |>
summarize(num_releases = n(),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = grouping_var) |>
rename(top_industry = x23_industry_sector, grouping_var = ..1)
return(result)
}
my(ma_2024, "county")
my <- function(data, area = c("county", "city", "zip")) {
grouping_var <- switch(area,
"county" = "x7_county",
"city" = "x6_city",
"zip" = "x8_zip")
temp <- data |>
group_by(.data[[grouping_var]], x23_industry_sector) |>
summarize(sum = n()) |>
arrange(desc(sum)) |>
slice(1) |>
select(!sum)
result <- data |>
group_by(.data[[grouping_var]]) |>
summarize(num_releases = n(),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = grouping_var) |>
rename(top_industry = x23_industry_sector)
return(result)
}
my(ma_2024, "county")
my <- function(data, area = c("county", "city", "zip")) {
grouping_var <- switch(area,
"county" = "x7_county",
"city" = "x6_city",
"zip" = "x8_zip")
temp <- data |>
group_by(.data[[grouping_var]], x23_industry_sector) |>
summarize(sum = n()) |>
arrange(desc(sum)) |>
slice(1) |>
select(!sum)
result <- data |>
group_by(.data[[grouping_var]]) |>
summarize(num_releases = n(),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = grouping_var) |>
rename(top_industry = x23_industry_sector) |>
rename_with(~ substring(., 4), .cols = 1)
return(result)
}
my(ma_2024, "county")
my(ma_2024, "city")
my(ma_2024, "zip")
my <- function(data, area = c("county", "city", "zip")) {
grouping_var <- switch(area,
"county" = "x7_county",
"city" = "x6_city",
"zip" = "x9_zip")
temp <- data |>
group_by(.data[[grouping_var]], x23_industry_sector) |>
summarize(sum = n()) |>
arrange(desc(sum)) |>
slice(1) |>
select(!sum)
result <- data |>
group_by(.data[[grouping_var]]) |>
summarize(num_releases = n(),
percent_carcinogen = (sum(x46_carcinogen == "YES") / n())*100,
percent_hazard = (sum(x42_clean_air_act_chemical == "NO") / n())*100) |>
left_join(temp,
by = grouping_var) |>
rename(top_industry = x23_industry_sector) |>
rename_with(~ substring(., 4), .cols = 1)
return(result)
}
my(ma_2024, "zip")
devtools::document()
devtools::document()
rm(chemstats)
devtools::document()
